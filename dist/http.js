"use strict";var _util=require("./util.js"),baseUrl="https://d.rsd123.com/",apiUrl=baseUrl+"wx.php",rendaUid=wx.getStorageSync("rendaUid"),header={"Content-Type":"application/x-www-form-urlencoded"};header=rendaUid?JSON.parse(JSON.stringify(Object.assign(header,{"http-uid":rendaUid}))):header;var http=function(e,a,t){return new Promise(function(i,d){wx.request({url:""+apiUrl+e,data:a,header:header,method:t||"POST",success:function(e){if(200===e.statusCode)if(200===e.data.status.code)i(e.data);else if(4e3===e.data.status.code||6100===e.data.status.code||888===e.data.status.code)(0,_util.wxToast)(e.data.status.remind),setTimeout(function(){wx.redirectTo({url:"/pages/login/welcome"})},300);else{var a=e.data.status.remind?e.data.status.remind:"没有信息";(0,_util.wxToast)(a)}else(0,_util.wxToast)("请求失败")},fail:function(e){(0,_util.wxToast)("网络失败"),d(e)}}).onHeadersReceived(function(e){})})},uploadFile=function(e){return new Promise(function(a,t){wx.uploadFile({url:apiUrl+"/Constant/moreupload",filePath:e[0],name:"image",success:function(e){e.data&&a(JSON.parse(e.data))},fail:function(e){t(e)}})})},uploadFileVideo=function(e){return new Promise(function(a,t){wx.uploadFile({url:apiUrl+"/uploadimg/moreupload",filePath:e[0],name:"image",success:function(e){e.data&&a(JSON.parse(e.data))},fail:function(e){t(e)}})})};module.exports={$http:http,uploadFile:uploadFile,uploadFileVideo:uploadFileVideo};