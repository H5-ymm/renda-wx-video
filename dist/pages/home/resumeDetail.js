"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_districtSelet=require("./../../components/districtSelet.js"),_districtSelet2=_interopRequireDefault(_districtSelet),_selectModal=require("./../../components/selectModal.js"),_selectModal2=_interopRequireDefault(_selectModal),_http=require("./../../http.js"),_util=require("./../../util.js"),resumeDetail=function(e){function t(){var e,i,r,a;_classCallCheck(this,t);for(var s=arguments.length,n=Array(s),o=0;o<s;o++)n[o]=arguments[o];return i=r=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n))),r.$repeat={},r.$props={districtSelet:{bindselectCity:"selectCity","xmlns:v-bind":"","v-bind:address.sync":"address"},selectModalWay:{"v-bind:isScaleModal.sync":"isSelectModal","v-bind:menus.sync":"menus",bindhandleClose:"handleClose",bindselectOk:"selectOk","v-bind:title.sync":"modalTitle"}},r.$events={},r.components={districtSelet:_districtSelet2.default,selectModalWay:_selectModal2.default},r.data={array:["男","女","男女不限"],eduList:["高中以下","高中","专科","本科","硕士"],index:0,eduIndex:0,form:{},type:1,uid:"",query:{},formTeam:{},address:[],status:0,id:"",recommendId:"",isSelectModal:!0,modalTitle:"请选择岗位性质",menus:[{icon:"https://a.rsd123.com/image/images/modal/icon3.png",title:"内部发单"},{icon:"https://a.rsd123.com/image/images/modal/icon4.png",title:"团队接单"}]},r.config={navigationBarTitleText:"简历信息"},r.computed={addressText:function(){return(this.form.provincenam?this.form.provincenam:"")+(this.form.cityname?this.form.cityname:"")}},r.events={selectCity:function(e){r.form.provinceid=e[0]?e[0]:0,r.form.cityid=e[1]?e[1]:0},selectOk:function(e){"请选择简历方式"==r.modalTitle?0===e?wx.navigateTo({url:"/pages/home/addInfo"}):r.createQrcode():(0,_util.wxNavigateTo)("/pages/teamView/internalInvoice/list?query="+e+"&resumeId="+r.query.resume_id+"&recommendId="+r.id)}},r.methods={bindPickerChange:function(e){this.index=e.detail.value,this.form.sex=Number(this.index)+1},eduPickerChange:function(e){this.eduIndex=e.detail.value,this.form.education=this.eduIndex},changeInput:function(e){var t=e.currentTarget.dataset.name;this.form[t]=e.detail.value},handleResume:function(e){var t=this;this.status=Number(e);var i=0===this.status?"/apply/del_put":1===this.status?"/apply/giveup_view":"/apply/giveup_entry",r=0===this.status?"放弃报名":1===this.status?"放弃面试":"放弃入职",a={uid:this.uid,ids:this.id};(0,_util.wxShowModal)("","确定"+r+"?","确定").then(function(e){t.changeResumeStatus(i,a)}).catch(function(){console.log("取消")})},routerResume:function(){this.isSelectModal=!this.isSelectModal,this.$apply()},save:function(){return this.form.age&&Number(this.form.age)<16?void(0,_util.wxToast)("请输入的年龄不小于16"):this.form.age&&Number(this.form.age)>65?void(0,_util.wxToast)("请输入的年龄不大于65"):void this.updateResume()}},a=i,_possibleConstructorReturn(r,a)}return _inherits(t,e),_createClass(t,[{key:"updateResume",value:function(){if(this.checkObj(this.form,this.formTeam))return void(0,_util.wxRedirectTo)("/pages/home/index");this.form=Object.assign(this.query,this.form),(0,_http.$http)("/Wxresume/editruseme",this.form).then(function(e){e.data?(0,_util.wxRedirectTo)("/pages/home/index"):(0,_util.wxToast)("修改失败")})}},{key:"getResumeDetail",value:function(e){var t=this;this.type=e.type,(0,_http.$http)("/Wxresume/getresume_recommend",e).then(function(e){t.form=e.data,t.form.from_user=e.data.from_user?e.data.from_user:"",t.form.to_user=e.data.to_user?e.data.to_user:"",t.form.age=e.data.age?e.data.age:"",t.eduIndex=e.data.education,0!=t.form.provinceid?t.address=[t.form.provinceid,t.form.cityid]:t.address=[],t.index=e.data.sex-1,t.formTeam=JSON.parse(JSON.stringify(t.form)),t.$apply()})}},{key:"checkObj",value:function(e,t){var i=!0;for(var r in e){if(e[r]!=t[r]){i=!1;break}i=!0}return i}},{key:"changeResumeStatus",value:function(e,t){(0,_http.$http)(e,t).then(function(e){e.data?((0,_util.wxToast)("操作成功"),(0,_util.wxRedirectTo)("/pages/home/index")):(0,_util.wxToast)("操作失败")})}},{key:"onLoad",value:function(e){this.uid=wx.getStorageSync("rendaUid")||this.$parent.globalData.uid,this.query={uid:this.uid,job_id:e.job_id,type:e.type,resume_id:e.resume_id},this.id=e.recommendId}},{key:"onShow",value:function(){this.getResumeDetail(this.query)}}]),t}(_wepy2.default.page);Page(require("./../../npm/wepy/lib/wepy.js").default.$createPage(resumeDetail,"pages/home/resumeDetail"));