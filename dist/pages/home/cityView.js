"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_http=require("./../../http.js"),_base=require("./../../base/base.js"),_util=require("./../../util.js"),flag=!1,cityView=function(e){function t(){var e,a,i,r;_classCallCheck(this,t);for(var n=arguments.length,s=Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=i=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.data={multiArray:[],cityList:_base.cityList,code:"",cityCode:"",areaCode:"",areaName:"",provinceName:"",cityName:"",address:"全国",options:[]},i.computed={addressText:function(){return this.provinceName+this.cityName+this.areaName}},i.config={navigationBarTitleText:"选择城市"},i.methods={selectCity:function(e,t){if(flag=!0,0==t)this.code="",this.address="全国",this.options=[];else if(1==t){this.address="",this.code=e.value,this.provinceName=e.name;var a=[e.value,""];this.getCityList(a)}else if(2==t)if(e.value){this.cityName=e.name,this.cityCode=e.value;var i=[this.code,e.value];this.getAreaList(i)}else this.address="全国",this.areaCode=e.value,this.areaName=e.name;else this.areaCode=e.value,this.areaName=e.name;t&&e.value&&"全国"==this.address&&(this.address=""),this.$apply()},save:function(){wx.setStorageSync("codeObj",JSON.stringify({code:this.areaCode,name:this.areaName})),wx.navigateBack({delta:1})},close:function(){wx.navigateBack({delta:1})}},r=a,_possibleConstructorReturn(i,r)}return _inherits(t,e),_createClass(t,[{key:"getList",value:function(e){return e.map(function(e){return{name:e.area_name,value:e.id}})}},{key:"getRegion",value:function(e){var t=this;(0,_http.$http)("/Constant/selectAddress",{parentId:""}).then(function(a){var i=t.getList(a.data);t.multiArray[0]=i,t.$apply(),t.getCityList(e)}).catch(function(e){})}},{key:"getCityList",value:function(e){var t=this,a="";a=e.length?e[0]:"110000",(0,_http.$http)("/Constant/selectAddress",{parentId:a}).then(function(a){var i=t.getList(a.data);i.length?(t.multiArray[1]=i,e[1]||(e[1]=i[0].value),t.getAreaList(e)):(t.multiArray[1]=[],t.multiArray[2]=[]),t.$apply()})}},{key:"getAreaList",value:function(e){var t=this,a="";a=e[1]?e[1]:"110100",(0,_http.$http)("/Constant/selectAddress",{parentId:a}).then(function(e){var a=t.getList(e.data);t.multiArray[2]=a,t.$apply()})}},{key:"onLoad",value:function(){this.getRegion([])}}]),t}(_wepy2.default.page);Page(require("./../../npm/wepy/lib/wepy.js").default.$createPage(cityView,"pages/home/cityView"));