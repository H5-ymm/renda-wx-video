"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_wepy=require("./../../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_districtSelet=require("./../../components/districtSelet.js"),_districtSelet2=_interopRequireDefault(_districtSelet),_dataPicker=require("./../../components/dataPicker.js"),_dataPicker2=_interopRequireDefault(_dataPicker),_pickerDate=require("./../../components/pickerDate.js"),_pickerDate2=_interopRequireDefault(_pickerDate),_moment=require("./../../npm/moment/moment.js"),_moment2=_interopRequireDefault(_moment),_http=require("./../../http.js"),_util=require("./../../util.js"),_base=require("./../../base/base.js"),editResume=function(t){function i(){var t,r,a,n;_classCallCheck(this,i);for(var s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];return r=a=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(o))),a.$repeat={},a.$props={districtSelet:{bindselectCity:"selectCity","v-bind:disabled.sync":"disabled","v-bind:address.sync":"address"},dataPicker:{"v-bind:range.sync":"jobStatusList","v-bind:value.sync":"jobStatusIndex"},dataEduPicker:{"v-bind:range.sync":"eduList","v-bind:value.sync":"eduIndex"},dataSexPicker:{"xmlns:v-bind":"","v-bind:range.sync":"array","v-bind:value.sync":"index","xmlns:v-on":""},pickerDate:{"v-bind:isScaleModal.sync":"isPicker"}},a.$events={dataPicker:{"v-on:bindPickerChange":"bindChange"},dataEduPicker:{"v-on:bindPickerChange":"bindEduChange"},dataSexPicker:{"v-on:bindPickerChange":"bindPickerChange"}},a.components={districtSelet:_districtSelet2.default,dataPicker:_dataPicker2.default,dataEduPicker:_dataPicker2.default,dataSexPicker:_dataPicker2.default,pickerDate:_pickerDate2.default},a.data={form:{nickname:"",job_search_status:"",sex:"",birthtime:"",tel:"",email:"",province:"",city:"",edu:""},array:["男","女"],eduList:["高中以下","高中","专科","本科","硕士"],index:0,eduIndex:0,disabled:!1,isPicker:!0,address:[],birthtime:"",jobStatusList:_base.jobStatusList,jobStatusIndex:-1},a.config={navigationBarTitleText:"编辑简历"},a.events={selectCity:function(e){a.form.province=e[0],a.form.city=e[1]}},a.methods={changeInput:function(e){var t=e.currentTarget.dataset.name;this.form[t]=e.detail.value},bindPickerChange:function(e){this.form.sex=Number(e)+1},bindEduChange:function(e){this.form.edu=e},bindChange:function(e){this.form.job_search_status=Number(e)+1},bindDateChange:function(){var t=e.currentTarget.dataset.name;this.birthtime=e.detail.value;var i=(0,_moment2.default)(e.detail.value).valueOf()+"";this.form[t]=i.substring(0,10),this.$apply()},submit:function(){this.form.nickname?this.form.sex?this.form.birthtime?this.form.province?this.form.job_search_status?this.form.edu?this.updateResume():(0,_util.wxToast)("请选择学历"):(0,_util.wxToast)("请选择求职状态"):(0,_util.wxToast)("请选择现居地址"):(0,_util.wxToast)("请选择出生年月"):(0,_util.wxToast)("请选择性别"):(0,_util.wxToast)("请输入姓名")}},n=r,_possibleConstructorReturn(a,n)}return _inherits(i,t),_createClass(i,[{key:"onShow",value:function(){wx.getStorageSync("userInfo")&&(this.form=JSON.parse(wx.getStorageSync("userInfo")),this.form.province&&(this.address=[this.form.province,this.form.city]),this.birthtime=this.form.birthtime?_moment2.default.unix(this.form.birthtime).format("YYYY-MM-DD"):"",this.eduIndex=this.form.edu?this.form.edu:"",this.jobStatusIndex=this.form.job_search_status?Number(this.form.job_search_status)-1:"",this.index=this.form.sex?Number(this.form.sex)-1:"",this.$apply())}},{key:"updateResume",value:function(){var e=this;this.form.uid=wx.getStorageSync("rendaUid")||this.$parent.globalData.uid,(0,_http.$http)("/Personal/edit_personal",this.form).then(function(t){t.data?((0,_util.wxToast)("保存成功"),wx.setStorageSync("userInfo",JSON.stringify(e.form)),(0,_util.wxRedirectTo)("/pages/my/resume")):(0,_util.wxToast)("保存失败")})}}]),i}(_wepy2.default.page);Page(require("./../../npm/wepy/lib/wepy.js").default.$createPage(editResume,"pages/my/editResume"));